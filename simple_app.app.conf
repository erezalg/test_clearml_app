id: "erez-test-app"
version: "1.0.0"
name: "Simple example application"
provider: "ClearML"
description: "A simple example of an application"
icon: "${ASSET:app-simple-app@2x.png}"
badges: []
details_page: "task"
no_info_html: "${ASSET:index.html}"
default_queue: "custom_apps_queue"

task {
    # task fields to use when creating the application task
    # will probably be a dump from an existing task by the creator of the app
    script {
        repository: "test_clearml_app.git"
        entry_point: "main.py"
        working_dir: ""
        branch: "master"
    }
    hyperparams {
        General {
             a_number: 30.0
             a_string: "testing 1, 2, 3"
             a_boolean: False
             a_project_id: ""
        }
    }
}

wizard {
    entries: [
        {
            name: a_project_field
            title: Choose a Project
            info: "The app will count the tasks in this project"
            type: dropdown
            required: true
            autocomplete: true
            choices {
                source: project
                value_field: id
                display_field: name
                filter {
                    fields {
                       name: "^Ex.*"
                    }
                }
            }
            target {
                field: hyperparams
                section: General
                name: a_project_id
            }
        }
        {
            type: list
            name: a_list
            title: A list
            display: "This is an example of a list"
            min_items: 1
            collapsibleTitleTemplate: "${number_field}"
            target: {
                field: configuration
                name: a_list
                format: json
            }
            item_template: [
                {
                    name: number_field
                    title: A Number
                    description: "This field is for a float number"
                    type: float
                    required: false
                }
            ]
        }
        {
            name: boolean_field
            title: A boolean choice
            default: false
            type: checkbox
            required: false
            target {
                field: hyperparams
                section: General
                name: a_bool
            }
        }
        {
            name: string_field
            title: A String
            info: "Select a sting to be passed to the application"
            type: string
            placeholder: "a string..."
            conditional: {
                entries: [
                    {
                        name: boolean_field
                        value: True
                    }
                ]
            }
            target {
                field: hyperparams
                section: General
                name: a_string
            }
        }
        {
            type: group
            name: more_options_group
            title: More options
            collapsible: true
            item_template: [
                {
                    name: a_text_field
                    title: Some Text
                    info: "Contains some text"
                    type: multiline_text
                    required: false
                    target: {
                        field: configuration
                        name: text_blob
                    }
                }
            ]
        }
    ]
}

dashboard {
    lines: [
        {
            style {
                height: "initial"
            }
            contents: [
                {
                    title: "HTML box with the string selected by the user"
                    type: html
                    text: "<h2>The string is ${hyperparams.General.a_string.value}</h2>"
                },
                {
                    title: "HTML box with the count of tasks"
                    type: html
                    text: "<h2>Project ${hyperparams.General.project_name.value} contains ${hyperparams.General.tasks_count.value} tasks</h2>"
                }
            ]
        }
        {
            contents: [
                {
                    title: "A random plot"
                    type: plot
                    metric: "Plots"
                    variant: "plot"
                }
            ]
        }
        {
            contents: [
                {
                    title: "Logs"
                    type: log
                }
            ]
        }
    ]
}
